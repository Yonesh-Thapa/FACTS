{% extends "layout.html" %}

{% block title %}F.A.C.T.S - Contact Us{% endblock %}

{% block head_extra %}
<!-- EmailJS SDK for email notifications -->
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
<script type="text/javascript">
    // Initialize EmailJS with public key
    (function() {
        emailjs.init("YGp-k-DkCxfL0UAbL"); // This is a public key, safe to expose
    })();
</script>
{% endblock %}

{% block content %}
<!-- Contact Header -->
<section class="page-header contact-header">
    <div class="container">
        <div class="row">
            <div class="col-12 text-center">
                <h1>Contact Us</h1>
                <p class="lead">Get in touch with our team to learn more about our program</p>
            </div>
        </div>
    </div>
</section>

<!-- Contact Information & Form -->
<section class="contact-section">
    <div class="container">
        <div class="row">
            <!-- Contact Information -->
            <div class="col-lg-5 mb-4 mb-lg-0">
                <div class="contact-info-card">
                    <h2>Get In Touch</h2>
                    <p>Have questions about our program or need more information? We're here to help you take the next step in your accounting career.</p>
                    
                    <div class="contact-details">
                        <div class="contact-item">
                            <div class="icon-box">
                                <i class="fas fa-envelope"></i>
                            </div>
                            <div class="contact-text">
                                <h4>Email</h4>
                                <a href="mailto:fatrainingservice@gmail.com">fatrainingservice@gmail.com</a>
                            </div>
                        </div>
                        
                        <div class="contact-item">
                            <div class="icon-box">
                                <i class="fas fa-phone"></i>
                            </div>
                            <div class="contact-text">
                                <h4>Phone</h4>
                                <a href="tel:0449547715">0449 547 715</a>
                            </div>
                        </div>
                        
                        <div class="contact-item">
                            <div class="icon-box">
                                <i class="fab fa-instagram"></i>
                            </div>
                            <div class="contact-text">
                                <h4>Instagram</h4>
                                <a href="https://www.instagram.com/future_accountants_cts?igsh=ZGUwY3FsNXFndDE4" target="_blank">@future_accountants_cts</a>
                            </div>
                        </div>
                        
                        <div class="contact-item">
                            <div class="icon-box">
                                <i class="fab fa-facebook"></i>
                            </div>
                            <div class="contact-text">
                                <h4>Facebook</h4>
                                <a href="https://www.facebook.com/Future-Accountants-Coaching-and-Training-Services" target="_blank">Future Accountants Coaching and Training Services</a>
                            </div>
                        </div>
                    </div>
                    
                    <div class="business-hours mt-4">
                        <h4>Business Hours</h4>
                        <p>Monday to Friday: 9:00 AM - 5:00 PM AEST</p>
                        <p>Weekend: By appointment only</p>
                    </div>
                </div>
            </div>
            
            <!-- Contact Form -->
            <div class="col-lg-7">
                <div class="contact-form-card">
                    <h2>Send Us a Message</h2>
                    <p>Fill out the form below and the F.A.C.T.S team will be in touch with you shortly.

</p>
                    
                    <form action="{{ url_for('contact') }}" method="POST" class="contact-form" id="contactForm">
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="name" class="form-label">Your Name <span class="text-danger">*</span></label>
                                <input type="text" class="form-control" id="name" name="name" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="email" class="form-label">Email Address <span class="text-danger">*</span></label>
                                <input type="email" class="form-control" id="email" name="email" required>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <label for="phone" class="form-label">Phone Number</label>
                            <input type="tel" class="form-control" id="phone" name="phone" placeholder="e.g. 0449 XXX XXX">
                        </div>
                        
                        <div class="mb-3">
                            <label for="subject" class="form-label">Subject</label>
                            <input type="text" class="form-control" id="subject" name="subject">
                        </div>
                        
                        <div class="mb-3">
                            <label for="message" class="form-label">Message <span class="text-danger">*</span></label>
                            <textarea class="form-control" id="message" name="message" rows="5" required></textarea>
                        </div>
                        
                        <div class="form-check mb-3">
                            <input class="form-check-input" type="checkbox" id="interested" name="interested">
                            <label class="form-check-label" for="interested">
                                I'm interested in enrolling in the upcoming session
                            </label>
                        </div>
                        
                        <button type="submit" class="btn btn-primary">Send Message</button>
                        
                        <!-- Hidden loading spinner -->
                        <div id="form-loading" class="d-none text-center mt-3">
                            <div class="spinner-border text-primary" role="status">
                                <span class="visually-hidden">Loading...</span>
                            </div>
                            <p class="mt-2">Sending your message...</p>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Google Maps or Location Information can be added here if needed -->

<!-- FAQ Section -->
<section class="faq-section">
    <div class="container">
        <div class="row">
            <div class="col-12 text-center mb-4">
                <h2 class="section-title">Frequently Asked Questions</h2>
                <div class="section-divider"></div>
            </div>
        </div>
        
        <div class="row">
            <div class="col-lg-10 mx-auto">
                <div class="accordion" id="faqAccordion">
                    <!-- FAQ Item 1 -->
                    <div class="accordion-item">
                        <h2 class="accordion-header" id="headingOne">
                            <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                                How is the course delivered?
                            </button>
                        </h2>
                        <div id="collapseOne" class="accordion-collapse collapse show" aria-labelledby="headingOne" data-bs-parent="#faqAccordion">
                            <div class="accordion-body">
                                The entire program is delivered online via live Zoom sessions. Each session is interactive, allowing you to ask questions and receive real-time feedback from our instructors. We also provide access to recordings of each session for review purposes.
                            </div>
                        </div>
                    </div>
                    
                    <!-- FAQ Item 2 -->
                    <div class="accordion-item">
                        <h2 class="accordion-header" id="headingTwo">
                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                                What if I miss a session?
                            </button>
                        </h2>
                        <div id="collapseTwo" class="accordion-collapse collapse" aria-labelledby="headingTwo" data-bs-parent="#faqAccordion">
                            <div class="accordion-body">
                                All sessions are recorded and made available to enrolled students. While we recommend attending live for the best interactive experience, you can catch up with any missed content through the recordings and follow-up with questions during the next session.
                            </div>
                        </div>
                    </div>
                    
                    <!-- FAQ Item 3 -->
                    <div class="accordion-item">
                        <h2 class="accordion-header" id="headingThree">
                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
                                Do I need to have accounting software installed?
                            </button>
                        </h2>
                        <div id="collapseThree" class="accordion-collapse collapse" aria-labelledby="headingThree" data-bs-parent="#faqAccordion">
                            <div class="accordion-body">
                                No, we provide temporary access to cloud-based versions of Xero and MYOB for the duration of the course. This means you don't need to purchase any software licenses to participate in the training program.
                            </div>
                        </div>
                    </div>
                    
                    <!-- FAQ Item 4 -->
                    <div class="accordion-item">
                        <h2 class="accordion-header" id="headingFour">
                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseFour" aria-expanded="false" aria-controls="collapseFour">
                                Is payment available in installments?
                            </button>
                        </h2>
                        <div id="collapseFour" class="accordion-collapse collapse" aria-labelledby="headingFour" data-bs-parent="#faqAccordion">
                            <div class="accordion-body">
                                Yes, we offer flexible payment plans. Please contact us directly to discuss your specific needs and we can arrange a payment schedule that works for you.
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
{% endblock %}

{% block scripts %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Get the contact form
    const contactForm = document.getElementById('contactForm');
    
    if (contactForm) {
        contactForm.addEventListener('submit', function(e) {
            // Prevent the default form submission
            e.preventDefault();
            
            // Show loading spinner
            document.getElementById('form-loading').classList.remove('d-none');
            
            // Get form data
            const name = document.getElementById('name').value;
            const email = document.getElementById('email').value;
            const phone = document.getElementById('phone').value || 'Not provided';
            const subject = document.getElementById('subject').value || 'Contact form submission';
            const message = document.getElementById('message').value;
            const interested = document.getElementById('interested').checked;
            
            // Create form data for AJAX submission
            const formData = new FormData();
            formData.append('name', name);
            formData.append('email', email);
            formData.append('phone', phone);
            formData.append('subject', subject);
            formData.append('message', message);
            formData.append('interested', interested ? 'on' : '');
            
            // Submit form via AJAX
            fetch('{{ url_for("contact") }}', {
                method: 'POST',
                body: formData,
                headers: {
                    'X-Requested-With': 'XMLHttpRequest'
                }
            })
            .then(response => response.json())
            .then(data => {
                // Hide loading spinner
                document.getElementById('form-loading').classList.add('d-none');
                
                if (data.success) {
                    // Show success message
                    const formContainer = contactForm.parentNode;
                    formContainer.innerHTML = `
                        <div class="text-center">
                            <div class="success-icon mb-4">
                                <i class="fas fa-check-circle fa-5x text-success"></i>
                            </div>
                            <h3 class="mb-3">Message Sent Successfully!</h3>
                            <p class="lead">${data.message}</p>
                            <p class="mt-3">We'll respond to your inquiry as soon as possible.</p>
                        </div>
                    `;
                    
                    // Still send backup email via EmailJS (redundancy)
                    const templateParams = {
                        to_email: 'fatrainingservice@gmail.com,hsenoy2022@gmail.com',
                        from_name: name,
                        from_email: email,
                        phone: phone,
                        subject: subject,
                        message: message,
                        interested: interested ? 'Yes' : 'No',
                        reply_to: email
                    };
                    
                    // Send the email using EmailJS as backup
                    emailjs.send('default_service', 'contact_form', templateParams)
                        .then(response => console.log('Backup email sent:', response))
                        .catch(error => console.error('Backup email failed:', error));
                } else {
                    // Show error message
                    const errorAlert = document.createElement('div');
                    errorAlert.className = 'alert alert-danger mt-3';
                    errorAlert.textContent = data.message || 'An error occurred. Please try again.';
                    contactForm.insertAdjacentElement('beforebegin', errorAlert);
                    
                    // Auto-hide error after 5 seconds
                    setTimeout(() => {
                        errorAlert.remove();
                    }, 5000);
                }
            })
            .catch(error => {
                console.error('Error:', error);
                document.getElementById('form-loading').classList.add('d-none');
                
                // Show error message
                const errorAlert = document.createElement('div');
                errorAlert.className = 'alert alert-danger mt-3';
                errorAlert.textContent = 'Network error. Please try again later.';
                contactForm.insertAdjacentElement('beforebegin', errorAlert);
                
                // Auto-hide error after 5 seconds
                setTimeout(() => {
                    errorAlert.remove();
                }, 5000);
            });
        });
    }
});
</script>

<!-- Add some CSS for the success message -->
<style>
.success-icon {
    animation: scaleIn 0.5s ease-in-out;
}

@keyframes scaleIn {
    0% { transform: scale(0); opacity: 0; }
    70% { transform: scale(1.1); opacity: 1; }
    100% { transform: scale(1); opacity: 1; }
}
</style>
{% endblock %}

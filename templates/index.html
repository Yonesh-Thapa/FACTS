{% extends "layout.html" %}

{% block title %}Accounting Training Australia | Xero & MYOB Training | F.A.C.T.S{% endblock %}

{% block content %}
<!-- Hero Section -->
<section class="hero-section">
    <div class="container">
        <div class="row align-items-center">
            <div class="col-lg-6">
                <h1 class="hero-title">{{ site_settings.home_hero_title or 'Launch Your Accounting Career with F.A.C.T.S' }}</h1>
                <h2 class="hero-subtitle">{{ site_settings.home_hero_subtitle or 'Job-Ready Online Training for Aspiring Accountants Across Australia' }}</h2>
                <div class="early-bird-banner mb-3">
                    <p>{{ get_dynamic_text(site_settings.home_early_bird_banner_template or 'üéâ Save ${savings} if you enroll by {deadline} ‚Äì Only {spots} seats per session!') }}</p>
                </div>
                <div class="countdown-timer mb-3">
                    <p class="countdown-label">‚è≥ Early Bird Offer Ends In:</p>
                    <div id="countdown-timer" class="countdown-display"></div>
                </div>
                <p class="session-info">Next Session Starts {{ computed.session_start_formatted }} ‚Äì {{ site_settings.session_days or 'Wed & Thu' }}, {{ site_settings.session_time or '7:00-9:00 PM AEST' }}</p>
                <p class="class-size-note"><i class="fas fa-users"></i> Only {{ site_settings.max_class_size or '10' }} students per session for personalized attention.</p>
                <a href="{{ url_for('contact') }}" class="btn btn-primary btn-lg hero-cta">Apply Now ‚Äì Secure Your Spot</a>
            </div>
            <div class="col-lg-6">
                <div class="hero-image">
                    <img src="{{ url_for('static', filename='images/' + (site_settings.hero_image or 'classroom_accounting.jpg')) }}" alt="Accounting Education Classroom" class="img-fluid">
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Intro Video and Why Choose F.A.C.T.S Section -->
<section class="intro-and-why-section py-5">
    <div class="container">
        <div class="row align-items-center">
            <!-- Video Column -->
            <div class="col-lg-6 mb-4 mb-lg-0">
                <h2 class="section-title text-center mb-4">{{ site_settings.mentor_section_title or 'Meet Your Mentor' }}</h2>
                <div class="section-divider mx-auto mb-4"></div>
                <div class="responsive-video-container">
                    <video id="mentor-video" 
                           class="responsive-video"
                           autoplay 
                           muted 
                           loop
                           playsinline
                           webkit-playsinline
                           x5-playsinline
                           preload="auto"
                           controls
                           controlsList="nodownload"
                           {% if site_settings.mentor_image %}
                           poster="{{ url_for('static', filename='images/' + site_settings.mentor_image) }}"
                           {% else %}
                           poster="{{ url_for('static', filename='images/tutor.jpg') }}"
                           {% endif %}>
                        <source src="{{ url_for('static', filename='videos/introVideo.mov') }}" type="video/mp4">
                        <source src="{{ url_for('static', filename='videos/introVideo.mov') }}" type="video/quicktime">
                        <p>Your browser doesn't support HTML5 video. <a href="{{ url_for('static', filename='videos/introVideo.mov') }}">Download the video</a> instead.</p>
                    </video>
                    <!-- Fallback play button for devices that block autoplay -->
                    <div id="video-play-overlay" class="video-play-overlay" style="display: none;">
                        <button class="play-button-large" onclick="playVideo()">
                            <i class="fas fa-play"></i>
                            <span>Click to Play</span>
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Why Choose F.A.C.T.S Column -->
            <div class="col-lg-6">
                <h2 class="section-title text-center mb-4">{{ site_settings.home_why_choose_title or 'Why Choose F.A.C.T.S?' }}</h2>
                <div class="section-divider mx-auto mb-4"></div>
                <div class="about-content">
                    <h3>Bridging the Gap from Graduation to Employment</h3>
                    <p>{{ site_settings.home_why_choose_description or 'F.A.C.T.S bridges the gap between your accounting education and real-world employment. Our comprehensive program combines practical software training, personalized career coaching, and job placement support to ensure you\'re ready for the workforce.' }}</p>
                    <div class="features-list">
                        <div class="feature-item">
                            <i class="fas fa-check-circle"></i>
                            <span>{{ site_settings.home_feature_1_title or 'Job-Ready Skills Training' }}: {{ site_settings.home_feature_1_desc or 'Comprehensive training in Xero & MYOB' }}</span>
                        </div>
                        <div class="feature-item">
                            <i class="fas fa-check-circle"></i>
                            <span>{{ site_settings.home_feature_2_title or 'Small Class Sizes' }}: {{ site_settings.home_feature_2_desc or 'Small class sizes for personalized attention' }}</span>
                        </div>
                        <div class="feature-item">
                            <i class="fas fa-check-circle"></i>
                            <span>{{ site_settings.home_feature_3_title or '100% Online Access' }}: {{ site_settings.home_feature_3_desc or '100% online, accessible from anywhere in Australia' }}</span>
                        </div>
                    </div>
                    <div class="mt-4">
                        <a href="{{ url_for('about') }}" class="btn btn-secondary me-2">Learn More About Us</a>
                        <a href="{{ url_for('program') }}" class="btn btn-secondary">See Program Details</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Program Highlights -->
<section class="program-highlights">
    <div class="container">
        <div class="row">
            <div class="col-12 text-center mb-4">
                <h2 class="section-title">{{ site_settings.home_program_highlights_title or 'Program Highlights' }}</h2>
                <div class="section-divider"></div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-6 mb-4">
                <div class="highlight-card">
                    <div class="highlight-icon">
                        <i class="fas fa-laptop-code"></i>
                    </div>
                    <h3>{{ site_settings.home_highlight_1_title or 'Practical Software Training' }}</h3>
                    <p>{{ site_settings.home_highlight_1_desc or 'Hands-on experience with Xero & MYOB' }}</p>
                </div>
            </div>
            <div class="col-md-6 mb-4">
                <div class="highlight-card">
                    <div class="highlight-icon">
                        <i class="fas fa-users"></i>
                    </div>
                    <h3>{{ site_settings.home_highlight_2_title or 'Live Instructor-Led Sessions' }}</h3>
                    <p>{{ site_settings.home_highlight_2_desc or 'Interactive online classes with real-time feedback, questions, and discussions with our expert instructors.' }}</p>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-6 mb-4">
                <div class="highlight-card">
                    <div class="highlight-icon">
                        <i class="fas fa-briefcase"></i>
                    </div>
                    <h3>{{ site_settings.home_highlight_3_title or 'Job Placement Support' }}</h3>
                    <p>{{ site_settings.home_highlight_3_desc or 'Resume workshops, LinkedIn profile optimization, and interview practice sessions to help you land your first accounting role.' }}</p>
                </div>
            </div>
            <div class="col-md-6 mb-4">
                <div class="highlight-card">
                    <div class="highlight-icon">
                        <i class="fas fa-robot"></i>
                    </div>
                    <h3>{{ site_settings.home_highlight_4_title or 'Future-Proof Skills (AI & Cybersecurity)' }}</h3>
                    <p>{{ site_settings.home_highlight_4_desc or 'As part of our commitment to future-proofing your skills, we include an introduction to AI tools and cybersecurity basics within the program, making you more competitive in the modern job market.' }}</p>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-12 text-center mt-4">
                <a href="{{ url_for('contact') }}" class="btn btn-primary btn-lg">Apply Now</a>
            </div>
        </div>
    </div>
</section>

<!-- Testimonials Section -->
<section class="testimonials-section py-5" style="background-color: #f1f8fe;">
    <div class="container">
        <div class="row">
            <div class="col-12 text-center mb-4">
                <h2 class="section-title">What Our Students Say</h2>
                <div class="section-divider"></div>
            </div>
        </div>
        <div class="row justify-content-center">
            <div class="col-lg-10 text-center">
                <div class="coming-soon-container p-5">
                    <i class="fas fa-hourglass-half fa-3x text-primary mb-3"></i>
                    <h3 class="mb-3">Student Testimonials Coming Soon</h3>
                    <p class="lead">We're collecting success stories from our graduates. Check back after our first cohort completes the program!</p>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Info Session Email Collection -->
<section class="info-session-section py-5" style="background-color: #ebf8ff;">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 mx-auto text-center">
                <div class="info-session-card p-4 rounded shadow-sm">
                    <h2 class="section-title">{{ site_settings.home_info_session_title or 'Join Our Free Info Session' }}</h2>
                    <div class="section-divider"></div>
                    <p class="lead mb-3">{{ site_settings.home_info_session_desc or 'Get all your questions answered and learn more about how F.A.C.T.S can help launch your accounting career.' }}</p>
                    
                    <div class="row">
                        <div class="col-lg-12">
                            <!-- Feature Badges -->
                            <div class="mb-3 d-flex justify-content-center flex-wrap">
                                <span class="badge bg-primary m-1">Free 1-on-1 Session</span>
                                <span class="badge bg-success m-1">No obligation</span>
                                <span class="badge bg-info text-dark m-1">Flexible Scheduling</span>
                                <span class="badge bg-warning text-dark m-1">Personalized Q&A</span>
                            </div>
                            
                            <!-- Custom Booking Form -->
                            {% from 'components/booking_form.html' import info_session_booking_form %}
                            {{ info_session_booking_form() }}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Early Bird Offer Section -->
<section class="early-bird-section py-5 bg-light">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 mx-auto text-center">
                <div class="early-bird-card">
                    <div class="ribbon ribbon-top-right"><span>Save {{ site_settings.currency or 'A' }}${{ computed.savings_amount or '550' }}</span></div>
                    <h2 class="section-title">Limited Time Early Bird Offer</h2>
                    <div class="section-divider"></div>
                    <p class="lead mb-4">Enroll before {{ computed.early_bird_deadline_display }} and save {{ site_settings.currency or 'A' }}${{ computed.savings_amount or '550' }} on your program fee.</p>
                    
                    <div class="countdown-container mb-4">
                        <p class="countdown-label">‚è≥ Early Bird Offer Ends In:</p>
                        <div id="homepage-offer-timer" class="countdown-display"></div>
                        <p class="mt-2"><a href="{{ url_for('pricing') }}" class="text-primary">View detailed pricing information</a></p>
                    </div>
                    
                    <div class="price-comparison mb-4">
                        <div class="row">
                            <div class="col-md-6 mb-3 mb-md-0">
                                <div class="price-card price-regular">
                                    <h5>Regular Price</h5>
                                    <div class="price">{{ site_settings.regular_price|format_currency }} <span>{{ site_settings.currency or 'AUD' }}</span></div>
                                    <div class="price-period">After {{ computed.early_bird_deadline_display }}</div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="price-card price-special highlighted">
                                    <h5>Early Bird Price</h5>
                                    <div class="price">{{ site_settings.early_bird_price|format_currency }} <span>{{ site_settings.currency or 'AUD' }}</span></div>
                                    <div class="price-period">Until {{ computed.early_bird_deadline_display }}</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <a href="{{ url_for('contact') }}" class="btn btn-primary btn-lg">Apply Now ‚Äì Secure Your Spot</a>
                    <p class="mt-2"><small>Limited spots available for upcoming sessions</small></p>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- CTA Section -->
<section class="cta-section">
    <div class="container">
        <div class="row">
            <div class="col-12 text-center">
                <h2>Ready to Launch Your Accounting Career?</h2>
                <p>Next Session Starts {{ computed.session_start_formatted }} ‚Äì {{ site_settings.session_days or 'Wed & Thu' }}, {{ site_settings.session_time or '7:00-9:00 PM AEST' }}</p>
                <a href="{{ url_for('contact') }}" class="btn btn-primary btn-lg mt-3">Apply Now ‚Äì Start Your Journey</a>
            </div>
        </div>
    </div>
</section>
{% endblock %}

{% block scripts %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Set the deadline date for all countdown timers (ISO 8601 format from Flask)
    // Always use ISO 8601 with 'T' for best browser compatibility
    const deadline = new Date('{{ computed.early_bird_deadline_js }}').getTime();
    // Find all countdown timers on the page
    const heroCountdown = document.getElementById('countdown-timer');
    const offerSectionCountdown = document.getElementById('homepage-offer-timer');
    // Cache for previous values to avoid unnecessary DOM updates
    const previousValues = {};
    
    // Set ARIA attributes once, not on every update
    if (heroCountdown) {
        heroCountdown.setAttribute('aria-live', 'off');
        heroCountdown.setAttribute('aria-atomic', 'true');
        heroCountdown.setAttribute('role', 'timer');
    }
    if (offerSectionCountdown) {
        offerSectionCountdown.setAttribute('aria-live', 'off');
        offerSectionCountdown.setAttribute('aria-atomic', 'true');
        offerSectionCountdown.setAttribute('role', 'timer');
    }
    
    // Update function for all timers
    function updateCountdowns() {
        const now = new Date().getTime();
        const timeRemaining = deadline - now;

        // Calculate time components
        const days = Math.floor(timeRemaining / (1000 * 60 * 60 * 24));
        const hours = Math.floor((timeRemaining % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
        const minutes = Math.floor((timeRemaining % (1000 * 60 * 60)) / (1000 * 60));
        const seconds = Math.floor((timeRemaining % (1000 * 60)) / 1000);

        // ...no debug print...

        // Check if countdown is finished
        if (timeRemaining < 0) {
            const expiredText = '<div class="countdown-expired">Offer has expired</div>';

            // Only update if content has changed
            if (heroCountdown && heroCountdown.innerHTML !== expiredText) {
                heroCountdown.innerHTML = expiredText;
                previousValues['hero'] = 'expired';
            }

            if (offerSectionCountdown && offerSectionCountdown.innerHTML !== expiredText) {
                offerSectionCountdown.innerHTML = expiredText;
                previousValues['offer'] = 'expired';
            }
            return;
        }

        // Create cache key
        const cacheKey = `${days}:${hours}:${minutes}:${seconds}`;

        // Format time display with individual boxes
        const formatCountdown = (days, hours, minutes, seconds) => {
            return `
                <div class="countdown-box">
                    <span class="countdown-number">${days}</span>
                    <span class="countdown-label">days</span>
                </div>
                <div class="countdown-box">
                    <span class="countdown-number">${hours}</span>
                    <span class="countdown-label">hours</span>
                </div>
                <div class="countdown-box">
                    <span class="countdown-number">${minutes}</span>
                    <span class="countdown-label">mins</span>
                </div>
                <div class="countdown-box">
                    <span class="countdown-number">${seconds}</span>
                    <span class="countdown-label">secs</span>
                </div>
            `;
        };

        const displayText = formatCountdown(days, hours, minutes, seconds);

        // Only update DOM if values changed
        if (heroCountdown && previousValues['hero'] !== cacheKey) {
            heroCountdown.innerHTML = displayText;
            previousValues['hero'] = cacheKey;
        }

        if (offerSectionCountdown && previousValues['offer'] !== cacheKey) {
            offerSectionCountdown.innerHTML = displayText;
            previousValues['offer'] = cacheKey;
        }
    }
    
    // Update immediately
    updateCountdowns();
    
    // Then update every second
    setInterval(updateCountdowns, 1000);
});
</script>
{% endblock %}
